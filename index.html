<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSE Highest Volumes</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
</head>
<body>
    <h1>NSE Highest Volumes</h1>
    <label for="level">Select Top Volume Level:</label>
    <select id="level">
        <option value="1">Top 1 Volume</option>
        <option value="2">Top 2 Volume</option>
        <option value="3">Top 3 Volume</option>
        <option value="4">Top 4 Volume</option>
        <option value="5">Top 5 Volume</option>
    </select>

    <button id="refreshButton">Refresh Data</button>

    <table id="volumeTable" class="display" style="width:100%">
        <thead>
            <tr>
                <th>Date</th>
                <th>Stock</th>
                <th>Volume</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>
        function loadData(level) {
            $('#volumeTable').DataTable({
                "processing": true,
                "serverSide": false, // Turn off server-side processing for simpler client-side sorting
                "destroy": true, // Allow reinitialization of the table
                "ajax": {
                    "url": "/data/" + level,
                    "dataSrc": ""
                },
                "columns": [
                    {"data": "Date"},
                    {"data": "Stock"},
                    {"data": "Volume"}
                ],
                "pageLength": 1000,
                "paging": true, // Enable paging
                "ordering": true, // Enable sorting
            });
        }

        $(document).ready(function() {
            var level = $('#level').val();
            loadData(level);

            $('#level').change(function() {
                level = $(this).val();
                loadData(level);
            });

            $('#refreshButton').click(function() {
                loadData(level); // Reload data when refresh button is clicked
            });
        });
    </script>
</body>
</html>
